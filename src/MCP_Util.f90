MODULE MCP_Util
  USE TypeDef,                  ONLY : Mixture_Type
  IMPLICIT NONE
  
  LOGICAL :: lMCP_Restart = .FALSE.
  INTEGER :: nMCP, nMCP_Plane
  CHARACTER(512), ALLOCATABLE :: MCP_Path(:)
  
  TYPE TYPE_MCP_Internal_Info
    INTEGER :: Macro_Region
    INTEGER :: Micro_Region
    REAL :: vol
  END TYPE

  TYPE TYPE_Radius
    INTEGER :: nRing
    REAL, ALLOCATABLE :: Ring_Volume(:)
    REAL, ALLOCATABLE :: Ring_Radius(:)
  END TYPE

  TYPE TYPE_MCP_Info
    INTEGER :: Assem_Type
    INTEGER :: nMaxMacro
    INTEGER :: nMaxMicro
    CHARACTER(256), ALLOCATABLE :: Micro_Char(:)
    INTEGER, ALLOCATABLE :: Micro_Number_Start(:)
    INTEGER, ALLOCATABLE :: Micro_Number_End(:)
    INTEGER, ALLOCATABLE :: Micro_Start(:)
    INTEGER, ALLOCATABLE :: Micro_End(:)
    INTEGER :: nCell
    INTEGER :: nCell45
    INTEGER :: nFXR = 0 !
    TYPE(TYPE_MCP_Internal_Info), ALLOCATABLE :: IntInfo(:)
    TYPE(Mixture_Type), ALLOCATABLE :: Mixture(:)

    TYPE(TYPE_Radius), ALLOCATABLE :: Radius(:)
  END TYPE
  
  CONTAINS
    SUBROUTINE isotope_number_chk(isotope_number, lExist_isotope, iMCP, j)
      USE IOutil,       ONLY : Terminate
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: iMCP, j
      INTEGER, INTENT(INOUT) :: isotope_number
      LOGICAL, INTENT(INOUT) :: lExist_isotope
      CHARACTER(100) :: mesg
      SELECT CASE(isotope_number)
        CASE(92234) !1   U-234
          lExist_isotope = .TRUE.
        CASE(92235) !2   U-235
          lExist_isotope = .TRUE.
        CASE(92236) !3   U-236
          lExist_isotope = .TRUE.
        CASE(92237) !4   U-237
          lExist_isotope = .TRUE.
        CASE(92238) !5   U-238
          lExist_isotope = .TRUE.
        CASE(8001)  !6   O in UO2 -> O16 for nTRACER
          lExist_isotope = .TRUE.
          isotope_number = 8016
        CASE(92239) !7   U-239
        CASE(92240) !8   U-240
        CASE(93234) !9   Np-234
        CASE(93235) !10  Np-235
        CASE(93236) !11  Np-236
        CASE(93237) !12  Np-237
          lExist_isotope = .TRUE.
        CASE(93238) !13  Np-238
          lExist_isotope = .TRUE.
        CASE(93239) !14  Np-239
          lExist_isotope = .TRUE.
        CASE(93240) !15  Np-240
        CASE(94236) !16  Pu-236
          lExist_isotope = .TRUE.
        CASE(94237) !17  Pu-237
        CASE(94238) !18  Pu-238
          lExist_isotope = .TRUE.
        CASE(94239) !19  Pu-239
          lExist_isotope = .TRUE.
        CASE(94240) !20  Pu-240
          lExist_isotope = .TRUE.
        CASE(94241) !21  Pu-241
          lExist_isotope = .TRUE.
        CASE(94242) !22  Pu-242
        CASE(94243) !23  Pu-243
        CASE(94244) !24  Pu-244
        CASE(95241) !25  Am-241
          lExist_isotope = .TRUE.
        CASE(95242) !26  Am-242
          lExist_isotope = .TRUE.
        CASE(95243) !27  Am-243
          lExist_isotope = .TRUE.
        CASE(95244) !28  Am-244
        CASE(95942) !29  Am-242m
          lExist_isotope = .TRUE.
          isotope_number = 95342
        CASE(96242) !30  Cm-242
          lExist_isotope = .TRUE.
        CASE(96243) !31  Cm-243
          lExist_isotope = .TRUE.
        CASE(96244) !32  Cm-244
          lExist_isotope = .TRUE.
        CASE(96245) !33  Cm-245
          lExist_isotope = .TRUE.
        CASE(96246) !34  Cm-246
          lExist_isotope = .TRUE.
        CASE(96247) !35  Cm-247
          lExist_isotope = .TRUE.
        CASE(96248) !36  Cm-248
          lExist_isotope = .TRUE.
        CASE(96249) !37  Cm-249
        CASE(96250) !38  Cm-250
        CASE(97245) !39  Bk-245
        CASE(97246) !40  Bk-246
        CASE(97247) !41  Bk-247
        CASE(97248) !42  Bk-248
        CASE(97249) !43  Bk-249
          lExist_isotope = .TRUE.
        CASE(97250) !44  Bk-250
        CASE(98248) !45  Cf-248
        CASE(98249) !46  Cf-249
          lExist_isotope = .TRUE.
        CASE(98250) !47  Cf-250
          lExist_isotope = .TRUE.
        CASE(98251) !48  Cf-251
          lExist_isotope = .TRUE.
        CASE(98252) !49  Cf-252
          lExist_isotope = .TRUE.
        CASE(32076) !50  Ge-76
        CASE(32977) !51  Ge-77m
        CASE(32077) !52  Ge-77
        CASE(33074) !53  As-74
        CASE(33075) !54  As-75
        CASE(33076) !55  As-76
        CASE(33077) !56  As-77
        CASE(33078) !57  As-78
        CASE(34076) !58  Se-76
        CASE(34077) !59  Se-77
        CASE(34078) !60  Se-78
        CASE(34079) !61  Se-79
        CASE(34080) !62  Se-80
        CASE(34081) !63  Se-81
        CASE(34082) !64  Se-82
        CASE(34083) !65  Se-83
        CASE(35079) !66  Br-79
        CASE(35080) !67  Br-80
        CASE(35081) !68  Br-81
          lExist_isotope = .TRUE.
          isotope_number = 35581
        CASE(35082) !69  Br-82
        CASE(35083) !70  Br-83
        CASE(35084) !71  Br-84
        CASE(36080) !72  Kr-80
        CASE(36081) !73  Kr-81
        CASE(36082) !74  Kr-82
          lExist_isotope = .TRUE.
          isotope_number = 36582
        CASE(36083) !75  Kr-83
          lExist_isotope = .TRUE.
          isotope_number = 36583
        CASE(36084) !76  Kr-84
          lExist_isotope = .TRUE.
          isotope_number = 36584
        CASE(36985) !77  Kr-85m
        CASE(36085) !78  Kr-85
          lExist_isotope = .TRUE.
          isotope_number = 36585
        CASE(36086) !79  Kr-86
          lExist_isotope = .TRUE.
          isotope_number = 36586
        CASE(36087) !80  Kr-87
        CASE(37085) !81  Rb-85
        CASE(37086) !82  Rb-86
        CASE(37087) !83  Rb-87
        CASE(38088) !84  Sr-88
        CASE(38089) !85  Sr-89
          lExist_isotope = .TRUE.
          isotope_number = 38589
        CASE(38090) !86  Sr-90
          lExist_isotope = .TRUE.
          isotope_number = 38590
        CASE(38091) !87  Sr-91
        CASE(39089) !88  Y-89
          lExist_isotope = .TRUE.
          isotope_number = 39589
        CASE(39090) !89  Y-90
          lExist_isotope = .TRUE.
          isotope_number = 39590
        CASE(39091) !90  Y-91
          lExist_isotope = .TRUE.
          isotope_number = 39591
        CASE(39092) !91  Y-92
        CASE(40090) !92  Zr-90
        CASE(40091) !93  Zr-91
          lExist_isotope = .TRUE.
          isotope_number = 40591
        CASE(40092) !94  Zr-92
        CASE(40093) !95  Zr-93
          lExist_isotope = .TRUE.
          isotope_number = 40593
        CASE(40094) !96  Zr-94
        CASE(40095) !97  Zr-95
          lExist_isotope = .TRUE.
          isotope_number = 40595
        CASE(40096) !98  Zr-96
          lExist_isotope = .TRUE.
          isotope_number = 40596
        CASE(40097) !99  Zr-97
        CASE(41293) !100 Nb-93
        CASE(41094) !101 Nb-94
        CASE(41095) !102 Nb-95
          lExist_isotope = .TRUE.
          isotope_number = 41595
        CASE(41096) !103 Nb-96
        CASE(41097) !104 Nb-97
        CASE(41098) !105 Nb-98
        CASE(42094) !106 Mo-94
        CASE(42095) !107 Mo-95
          lExist_isotope = .TRUE.
          isotope_number = 42595
        CASE(42096) !108 Mo-96
          lExist_isotope = .TRUE.
          isotope_number = 42596
        CASE(42097) !109 Mo-97
          lExist_isotope = .TRUE.
          isotope_number = 42597
        CASE(42098) !110 Mo-98
          lExist_isotope = .TRUE.
          isotope_number = 42598
        CASE(42099) !111 Mo-99
          lExist_isotope = .TRUE.
          isotope_number = 42599
        CASE(42100) !112 Mo-100
          lExist_isotope = .TRUE.
          isotope_number = 42600
        CASE(42101) !113 Mo-101
        CASE(43098) !114 Tc-98
        CASE(43099) !115 Tc-99
          lExist_isotope = .TRUE.
          isotope_number = 43599
        CASE(43100) !116 Tc-100
        CASE(43101) !117 Tc-101
        CASE(43102) !118 Tc-102
        CASE(44098) !119 Ru-98
        CASE(44099) !120 Ru-99
        CASE(44100) !121 Ru-100
          lExist_isotope = .TRUE.
          isotope_number = 44600
        CASE(44101) !122 Ru-101
          lExist_isotope = .TRUE.
          isotope_number = 44601
        CASE(44102) !123 Ru-102
          lExist_isotope = .TRUE.
          isotope_number = 44602
        CASE(44103) !124 Ru-103
          lExist_isotope = .TRUE.
          isotope_number = 44603
        CASE(44104) !125 Ru-104
          lExist_isotope = .TRUE.
          isotope_number = 44604
        CASE(44105) !126 Ru-105
          lExist_isotope = .TRUE.
          isotope_number = 44605
        CASE(44106) !127 Ru-106
          lExist_isotope = .TRUE.
          isotope_number = 44606
        CASE(45103) !128 Rh-103
          lExist_isotope = .TRUE.
          isotope_number = 45603
        CASE(45104) !129 Rh-104
        CASE(45105) !130 Rh-105
          lExist_isotope = .TRUE.
          isotope_number = 45605
        CASE(45106) !131 Rh-106
        CASE(45107) !132 Rh-107
        CASE(46104) !133 Pd-104
          lExist_isotope = .TRUE.
          isotope_number = 46604
        CASE(46105) !134 Pd-105
          lExist_isotope = .TRUE.
          isotope_number = 46605
        CASE(46106) !135 Pd-106
          lExist_isotope = .TRUE.
          isotope_number = 46606
        CASE(46107) !136 Pd-107
          lExist_isotope = .TRUE.
          isotope_number = 46607
        CASE(46108) !137 Pd-108
          lExist_isotope = .TRUE.
          isotope_number = 46608
        CASE(46109) !138 Pd-109
        CASE(46110) !139 Pd-110
        CASE(46111) !140 Pd-111
        CASE(47205) !141 Ag-105f
        CASE(47206) !142 Ag-106f
        CASE(47207) !143 Ag-107f
        CASE(47208) !144 Ag-108f
        CASE(47209) !145 Ag-109f
          lExist_isotope = .TRUE.
          isotope_number = 47609
        CASE(47810) !146 Ag-110m
          lExist_isotope = .TRUE.
          isotope_number = 47710
        CASE(47210) !147 Ag-110f
        CASE(47211) !148 Ag-111f
          lExist_isotope = .TRUE.
          isotope_number = 47611
        CASE(47212) !149 Ag-112f
        CASE(48206) !150 Cd-106f
        CASE(48207) !151 Cd-107f
        CASE(48208) !152 Cd-108f
        CASE(48209) !153 Cd-109f
        CASE(48210) !154 Cd-110f
          lExist_isotope = .TRUE.
          isotope_number = 48610
        CASE(48211) !155 Cd-111f
          lExist_isotope = .TRUE.
          isotope_number = 48611
        CASE(48212) !156 Cd-112f
        CASE(48213) !157 Cd-113f
         lExist_isotope = .TRUE.
          isotope_number = 48613
        CASE(48214) !158 Cd-114f
        CASE(48215) !159 Cd-115f
        CASE(48216) !160 Cd-116f
        CASE(48217) !161 Cd-117f
        CASE(48218) !162 Cd-118f
        CASE(49213) !163 In-113f
        CASE(49214) !164 In-114f
        CASE(49215) !165 In-115f
          lExist_isotope = .TRUE.
          isotope_number = 49615
        CASE(49216) !166 In-116f
        CASE(49217) !167 In-117f
        CASE(49218) !168 In-118f
        CASE(50112) !169 Sn-112
          lExist_isotope = .TRUE.
        CASE(50113) !170 Sn-113
        CASE(50114) !171 Sn-114 
          lExist_isotope = .TRUE.
        CASE(50115) !172 Sn-115
          lExist_isotope = .TRUE.
        CASE(50116) !173 Sn-116
          lExist_isotope = .TRUE.
        CASE(50117) !174 Sn-117
          lExist_isotope = .TRUE.
        CASE(50118) !175 Sn-118
          lExist_isotope = .TRUE.
        CASE(50119) !176 Sn-119
          lExist_isotope = .TRUE.
        CASE(50120) !177 Sn-120
          lExist_isotope = .TRUE.
        CASE(50121) !178 Sn-121
        CASE(50122) !179 Sn-122
          lExist_isotope = .TRUE.
        CASE(50923) !180 Sn-123m
        CASE(50123) !181 Sn-123
        CASE(50124) !182 Sn-124
          lExist_isotope = .TRUE.
        CASE(50925) !183 Sn-125m
        CASE(50125) !184 Sn-125
          lExist_isotope = .TRUE.
        CASE(50126) !185 Sn-126
        CASE(50127) !186 Sn-127
        CASE(51121) !187 Sb-121
          lExist_isotope = .TRUE.
        CASE(51122) !188 Sb-122
        CASE(51123) !189 Sb-123
          lExist_isotope = .TRUE.
        CASE(51124) !190 Sb-124
        CASE(51125) !191 Sb-125
          lExist_isotope = .TRUE.
          isotope_number = 51625
        CASE(51126) !192 Sb-126
        CASE(51127) !193 Sb-127
          lExist_isotope = .TRUE.
          isotope_number = 51627
        CASE(51128) !194 Sb-128
        CASE(52122) !195 Te-122
        CASE(52123) !196 Te-123
        CASE(52124) !197 Te-124
        CASE(52125) !198 Te-125
        CASE(52126) !199 Te-126
        CASE(52927) !200 Te-127m
          lExist_isotope = .TRUE.
          isotope_number = 52727
        CASE(52127) !201 Te-127
        CASE(52128) !202 Te-128
        CASE(52929) !203 Te-129m 
          lExist_isotope = .TRUE.
          isotope_number = 52729
        CASE(52129) !204 Te-129
        CASE(52130) !205 Te-130
        CASE(52131) !206 Te-131
        CASE(52132) !207 Te-132
          lExist_isotope = .TRUE.
          isotope_number = 52632
        CASE(53127) !208 I-127
          lExist_isotope = .TRUE.
          isotope_number = 53627
        CASE(53128) !209 I-128
        CASE(53129) !210 I-129
          lExist_isotope = .TRUE.
          isotope_number = 53629
        CASE(53130) !211 I-130
        CASE(53131) !212 I-131
          lExist_isotope = .TRUE.
          isotope_number = 53631
        CASE(53132) !213 I-132
        CASE(53133) !214 I-133
        CASE(53134) !215 I-134
        CASE(53135) !216 I-135
          lExist_isotope = .TRUE.
          isotope_number = 53635
        CASE(53136) !217 I-136
        CASE(54128) !218 Xe-128
          lExist_isotope = .TRUE.
          isotope_number = 54628
        CASE(54129) !219 Xe-129
        CASE(54130) !220 Xe-130
          lExist_isotope = .TRUE.
          isotope_number = 54630
        CASE(54131) !221 Xe-131
          lExist_isotope = .TRUE.
          isotope_number = 54631
        CASE(54132) !222 Xe-132
          lExist_isotope = .TRUE.
          isotope_number = 54632
        CASE(54133) !223 Xe-133
          lExist_isotope = .TRUE.
          isotope_number = 54633
        CASE(54134) !224 Xe-134
          lExist_isotope = .TRUE.
          isotope_number = 54634
        CASE(54935) !225 Xe-135m
        CASE(54135) !226 Xe-135
          lExist_isotope = .TRUE.
          isotope_number = 54635
        CASE(54136) !227 Xe-136
          lExist_isotope = .TRUE.
          isotope_number = 54636
        CASE(54137) !228 Xe-137
        CASE(55133) !229 Cs-133
          lExist_isotope = .TRUE.
          isotope_number = 55633
        CASE(55134) !230 Cs-134
          lExist_isotope = .TRUE.
          isotope_number = 55634
        CASE(55135) !231 Cs-135
          lExist_isotope = .TRUE.
          isotope_number = 55635
        CASE(55136) !232 Cs-136
          lExist_isotope = .TRUE.
          isotope_number = 55636
        CASE(55137) !233 Cs-137
          lExist_isotope = .TRUE.
          isotope_number = 55637
        CASE(55138) !234 Cs-138
        CASE(56134) !235 Ba-134
          lExist_isotope = .TRUE.
          isotope_number = 56634
        CASE(56135) !236 Ba-135
        CASE(56136) !237 Ba-136
        CASE(56137) !238 Ba-137
          lExist_isotope = .TRUE.
          isotope_number = 56637
        CASE(56138) !239 Ba-138
        CASE(56139) !240 Ba-139
        CASE(56140) !241 Ba-140
          lExist_isotope = .TRUE.
          isotope_number = 56640
        CASE(57138) !242 La-138
        CASE(57139) !243 La-139
          lExist_isotope = .TRUE.
          isotope_number = 57639
        CASE(57140) !244 La-140
          lExist_isotope = .TRUE.
          isotope_number = 57640
        CASE(57141) !245 La-141
        CASE(58138) !246 Ce-138
        CASE(58139) !247 Ce-139
        CASE(58140) !248 Ce-140
          lExist_isotope = .TRUE.
          isotope_number = 58640
        CASE(58141) !249 Ce-141
          lExist_isotope = .TRUE.
          isotope_number = 58641
        CASE(58142) !250 Ce-142
          lExist_isotope = .TRUE.
          isotope_number = 58642
        CASE(58143) !251 Ce-143
          lExist_isotope = .TRUE.
          isotope_number = 58643
        CASE(58144) !252 Ce-144
          lExist_isotope = .TRUE.
          isotope_number = 58644
        CASE(59141) !253 Pr-141
          lExist_isotope = .TRUE.
          isotope_number = 59641
        CASE(59142) !254 Pr-142
        CASE(59143) !255 Pr-143
          lExist_isotope = .TRUE.
          isotope_number = 59643
        CASE(59144) !256 Pr-144
        CASE(60142) !257 Nd-142
          lExist_isotope = .TRUE.
          isotope_number = 60642
        CASE(60143) !258 Nd-143
          lExist_isotope = .TRUE.
          isotope_number = 60643
        CASE(60144) !259 Nd-144
          lExist_isotope = .TRUE.
          isotope_number = 60644
        CASE(60145) !260 Nd-145
          lExist_isotope = .TRUE.
          isotope_number = 60645
        CASE(60146) !261 Nd-146
          lExist_isotope = .TRUE.
          isotope_number = 60646
        CASE(60147) !262 Nd-147
          lExist_isotope = .TRUE.
          isotope_number = 60647
        CASE(60148) !263 Nd-148
          lExist_isotope = .TRUE.
          isotope_number = 60648
        CASE(60149) !264 Nd-149
        CASE(60150) !265 Nd-150
          lExist_isotope = .TRUE.
          isotope_number = 60650
        CASE(60151) !266 Nd-151
        CASE(61146) !267 Pm-146
        CASE(61147) !268 Pm-147
          lExist_isotope = .TRUE.
          isotope_number = 61647
        CASE(61948) !269 Pm-148m
          lExist_isotope = .TRUE.
          isotope_number = 61748
        CASE(61148) !270 Pm-148
          lExist_isotope = .TRUE.
          isotope_number = 61648
        CASE(61149) !271 Pm-149
          lExist_isotope = .TRUE.
          isotope_number = 61649
        CASE(61150) !272 Pm-150
        CASE(61151) !273 Pm-151
          lExist_isotope = .TRUE.
          isotope_number = 61651
        CASE(62147) !274 Sm-147
          lExist_isotope = .TRUE.
          isotope_number = 62647
        CASE(62148) !275 Sm-148
          lExist_isotope = .TRUE.
          isotope_number = 62648
        CASE(62149) !276 Sm-149
          lExist_isotope = .TRUE.
          isotope_number = 62649
        CASE(62150) !277 Sm-150
          lExist_isotope = .TRUE.
          isotope_number = 62650
        CASE(62151) !278 Sm-151
          lExist_isotope = .TRUE.
          isotope_number = 62651
        CASE(62152) !279 Sm-152
          lExist_isotope = .TRUE.
          isotope_number = 62652
        CASE(62153) !280 Sm-153
          lExist_isotope = .TRUE.
          isotope_number = 62653
        CASE(62154) !281 Sm-154
          lExist_isotope = .TRUE.
          isotope_number = 62654
        CASE(62155) !282 Sm-155
        CASE(62156) !283 Sm-156
        CASE(63153) !284 Eu-153
          lExist_isotope = .TRUE.
          isotope_number = 63653
        CASE(63154) !285 Eu-154
          lExist_isotope = .TRUE.
          isotope_number = 63654
        CASE(63155) !286 Eu-155
          lExist_isotope = .TRUE.
          isotope_number = 63655
        CASE(63156) !287 Eu-156
          lExist_isotope = .TRUE.
          isotope_number = 63656
        CASE(63157) !288 Eu-157
          lExist_isotope = .TRUE.
          isotope_number = 63657
        CASE(63158) !289 Eu-158
        CASE(64253) !290 Gd-153f
        CASE(64254) !291 Gd-154f
          lExist_isotope = .TRUE.
          isotope_number = 64654
        CASE(64255) !292 Gd-155f
          lExist_isotope = .TRUE.
          isotope_number = 64655
        CASE(64256) !293 Gd-156f
          lExist_isotope = .TRUE.
          isotope_number = 64656
        CASE(64257) !294 Gd-157f
          lExist_isotope = .TRUE.
          isotope_number = 64657
        CASE(64258) !295 Gd-158f
          lExist_isotope = .TRUE.
          isotope_number = 64658
        CASE(64259) !296 Gd-159f
        CASE(64260) !297 Gd-160f
          lExist_isotope = .TRUE.
          isotope_number = 64660
        CASE(64261) !298 Gd-161f
        CASE(65259) !299 Tb-159f
          lExist_isotope = .TRUE.
          isotope_number = 65659
        CASE(65260) !300 Tb-160f
          lExist_isotope = .TRUE.
          isotope_number = 65660
        CASE(65261) !301 Tb-161f
          lExist_isotope = .TRUE.
          isotope_number = 65661
        CASE(66260) !302 Dy-160f
          lExist_isotope = .TRUE.
          isotope_number = 66660
        CASE(66261) !303 Dy-161f
          lExist_isotope = .TRUE.
          isotope_number = 66661
        CASE(66262) !304 Dy-162f
          lExist_isotope = .TRUE.
          isotope_number = 66662
        CASE(66263) !305 Dy-163f
          lExist_isotope = .TRUE.
          isotope_number = 66663
        CASE(66264) !306 Dy-164f
          lExist_isotope = .TRUE.
          isotope_number = 66664
        CASE(66265) !307 Dy-165f
        CASE(67265) !308 Ho-165f
          lExist_isotope = .TRUE.
          isotope_number = 67665
        CASE(64154) !309 Gd-154
          lExist_isotope = .TRUE.
        CASE(64155) !310 Gd-155
          lExist_isotope = .TRUE.
        CASE(64156) !311 Gd-156
          lExist_isotope = .TRUE.
        CASE(64157) !312 Gd-157
          lExist_isotope = .TRUE.
        CASE(64158) !313 Gd-158
          lExist_isotope = .TRUE.
        CASE(64152) !314 Gd-152
          lExist_isotope = .TRUE.
        CASE(64160) !315 Gd-160
          lExist_isotope = .TRUE.
        CASE(64153) !316 Gd-153
        CASE(64159) !317 Gd-159
        CASE(64161) !318 Gd-161
        CASE(65159) !319 Tb-159
          lExist_isotope = .TRUE.
        CASE(65160) !320 Tb-160
          lExist_isotope = .TRUE.
        CASE(65161) !321 Tb-161
          lExist_isotope = .TRUE.
        CASE(66160) !322 Dy-160
          lExist_isotope = .TRUE.
        CASE(66161) !323 Dy-161
          lExist_isotope = .TRUE.
        CASE(66162) !324 Dy-162
          lExist_isotope = .TRUE.
        CASE(66163) !325 Dy-163
          lExist_isotope = .TRUE.
        CASE(66164) !326 Dy-164
          lExist_isotope = .TRUE.
        CASE(66165) !327 Dy-165
        CASE(67165) !328 Ho-165
          lExist_isotope = .TRUE.
        CASE DEFAULT
          WRITE(mesg, '(a, i5, a, i5, a, i5)') 'Cannot read Isotope ID : ', isotope_number, '  MCP File No.: ', iMCP, '  Micro-region: ', j
          CALL terminate(mesg)
      END SELECT
    END SUBROUTINE
END MODULE